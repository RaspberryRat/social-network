<% user = @user %>

<div class="user-navbar">
  <div class="user-name"><%= user.username %>'s Page</div>
  <div class="root-link">
    <div><%= link_to 'Main Page', root_path %></div>
  </div>
  <div class="notifications">

    <% if current_user == user %>
      <div class="friend-requests">
        <div>You have a friend request from:


        </div>
        <%= link_to 'See Friend Requests', user_friendships_path(user) %>
      </div>
    <% end %>
  </div>
</div>

<ul>
  <li>Name: <%= user.username %></li>
  <li>Email: <%= user.email %></li>
</ul>

<div class="friend-list">
  <ul>
    <% friend_num = 1 %>
    <% user.friends.each do |friend| %>
      <% friendship = Friendship.find_by(
        user_id: user.id, friend_id: friend.id
        ) %>
      <% if friendship.confirmed? == true %>
        <li>Friend # <%=friend_num %>:
          Friend's name: <%= friend.username %>
        </li>
        <li>
          Friend's email: <%= friend.email %>
        </li>
        <br />
      <% end %>
        <% friend_num += 1 %>
    <% end %>
  </ul>
</div>

<% if current_user != user &&
  user_signed_in? &&
  !current_user.friends.include?(user)%>

  <div class="add-friend">
    <%= form_with model: @friendship,
      url: user_friendships_path(@user), method: :post do |f| %>
      <%= f.hidden_field :friend_id, value: user.id %>
      <%= f.submit 'Send Friend Request' %>
    <% end %>
  </div>
<% end %>


<div class="user-posts">
  <p><%= user.username %>'s Posts</p>
  <% @posts.each do |post| %>
    <ul>
      <%= turbo_frame_tag post do %>
        <li><%= post.title %></li>
        <li><%= post.content %></li>
        <li><%=link_to 'Edit Post', edit_user_post_path(user, post) %> </li>
      <% end %>
    </ul>
  <% end %>
</div>

<% if current_user == user %>
  <div class="new-posts-link">
    <%= turbo_frame_tag 'new post' do %>
      <%= link_to 'Add a post', new_user_post_path(user)  %>
    <% end %>
  </div>
<% end %>
